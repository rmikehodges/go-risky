CREATE OR REPLACE FUNCTION risky_public.vulnerabilities(fn_business_id uuid) 
RETURNS SETOF risky_public.vulnerability 
AS $$
    SELECT * FROM risky_public.vulnerability WHERE business_id = fn_business_id;
$$ LANGUAGE sql;

CREATE OR REPLACE FUNCTION risky_public.get_vulnerability(fn_vulnerability_id uuid) 
RETURNS risky_public.vulnerability 
AS $$
    SELECT * FROM risky_public.vulnerability WHERE id = fn_vulnerability_id;
$$ LANGUAGE sql;

CREATE OR REPLACE FUNCTION risky_public.delete_vulnerability(fn_vulnerability_id uuid) 
RETURNS void 
AS $$
    DELETE FROM risky_public.vulnerability WHERE id = fn_vulnerability_id;
$$ LANGUAGE sql VOLATILE;

CREATE OR REPLACE FUNCTION risky_public.create_vulnerability(fn_name varchar, fn_description varchar) 
RETURNS void
AS $$
    INSERT INTO risky_public.vulnerability(name, description) values(fn_name, fn_description);
$$ LANGUAGE sql VOLATILE;


CREATE OR REPLACE FUNCTION risky_public.update_vulnerability(fn_vulnerability_id uuid, fn_name varchar,  fn_description varchar) 
RETURNS void 
AS $$
    UPDATE risky_public.vulnerability SET name = fn_name, description = fn_description WHERE id = fn_vulnerability_id;
$$ LANGUAGE sql VOLATILE;
